name: Lint

on: push

jobs:
  run-linters:
    name: Run linters
    runs-on: ubuntu-latest

    steps:
      - name: Check out Git repository
        uses: actions/checkout@v3

      - name: Set up Node.js
        uses: actions/setup-node@v3
        with:
          node-version: 18
          cache: 'npm'

      - name: Install Node.js dependencies
        run: npm ci

      - name: Install linters
        run: npm install --save-dev eslint prettier

      - name: Run ESLint
        run: npx eslint . --format json --max-warnings=0 > eslint-report.json || true

      - name: Annotate ESLint results
        if: success() || failure()
        run: |
          eslint_result=$(cat eslint-report.json)
          echo "ESLint results: $eslint_result"
        
      - name: Run Prettier
        run: npx prettier --check . --verbose || true

      - name: Annotate Prettier results
        if: success() || failure()
        run: |
          prettier_result=$(npx prettier --check . --verbose)
          echo "Prettier results: $prettier_result"
